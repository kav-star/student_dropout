<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analytics - Dropout Insights</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="static/styles.css">
</head>

<body class="analytics-page">

  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-content">
      <div class="logo">
        <img src="images/logo.png" alt="DropoutAI Logo" width="40" height="40">
        <span>DropoutAI</span>
      </div>
      <ul class="nav-links">
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="analytics_page.html" class="active">Analytics</a></li>
        <li><a href="about_page.html">About</a></li>
        <li><a href="contact_page.html">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- Page header -->
  <div class="page-header">
    <h1 class="page-title">Analytics</h1>
    <p class="page-subtitle">Visualize dropout data with interactive charts</p>
  </div>

  <!-- Charts grid -->
  <div class="charts-grid">
    <!-- Dynamic Chart -->
    <div class="chart-card">
      <h3>Custom Analysis</h3>
      <div class="controls">
        <label for="xSelect">X-Axis:</label>
        <select id="xSelect">
          <option value="year">Year</option>
          <option value="region">Region</option>
          <option value="gender">Gender</option>
        </select>
        <label for="ySelect">Y-Axis:</label>
        <select id="ySelect">
          <option value="dropoutRate">Dropout Rate</option>
          <option value="students">Number of Students</option>
        </select>
      </div>
      <canvas id="dynamicChart"></canvas>
    </div>

    <!-- Line Chart -->
    <div class="chart-card">
      <h3>Dropout Trends (Line)</h3>
      <canvas id="lineChart"></canvas>
    </div>

    <!-- Pie Chart -->
    <div class="chart-card">
      <h3>Dropout by Gender (Pie)</h3>
      <canvas id="pieChart"></canvas>
    </div>

    <!-- Bar Chart -->
    <div class="chart-card">
      <h3>Regional Dropouts (Bar)</h3>
      <canvas id="barChart"></canvas>
    </div>
  </div>

  <script>
    // Mock dataset
    const dataset = [
      { year: 2018, region: "North", gender: "Male", students: 1200, dropoutRate: 12 },
      { year: 2018, region: "North", gender: "Female", students: 1100, dropoutRate: 10 },
      { year: 2019, region: "South", gender: "Male", students: 1400, dropoutRate: 15 },
      { year: 2019, region: "South", gender: "Female", students: 1300, dropoutRate: 13 },
      { year: 2020, region: "East", gender: "Male", students: 1250, dropoutRate: 14 },
      { year: 2020, region: "East", gender: "Female", students: 1200, dropoutRate: 11 }
    ];

    // Utility: group data
    function groupData(xAttr, yAttr) {
      const grouped = {};
      dataset.forEach(d => {
        const key = d[xAttr];
        if (!grouped[key]) grouped[key] = 0;
        grouped[key] += d[yAttr];
      });
      return grouped;
    }

    // Dynamic Chart
    const ctxDynamic = document.getElementById("dynamicChart").getContext("2d");
    let dynamicChart = new Chart(ctxDynamic, {
      type: "bar",
      data: { labels: [], datasets: [{ label: "", data: [], backgroundColor: "#667eea" }] },
      options: { responsive: true, plugins: { legend: { display: false } } }
    });

    function updateDynamicChart() {
      const xAttr = document.getElementById("xSelect").value;
      const yAttr = document.getElementById("ySelect").value;
      const grouped = groupData(xAttr, yAttr);

      dynamicChart.data.labels = Object.keys(grouped);
      dynamicChart.data.datasets[0].data = Object.values(grouped);
      dynamicChart.data.datasets[0].label = `${yAttr} by ${xAttr}`;
      dynamicChart.update();
    }

    document.getElementById("xSelect").addEventListener("change", updateDynamicChart);
    document.getElementById("ySelect").addEventListener("change", updateDynamicChart);

    updateDynamicChart();

    // Line Chart
    new Chart(document.getElementById("lineChart"), {
      type: "line",
      data: {
        labels: ["2018", "2019", "2020"],
        datasets: [{
          label: "Dropout Rate (%)",
          data: [11, 14, 12],
          borderColor: "#1e3a8a",
          backgroundColor: "rgba(102,126,234,0.3)",
          fill: true,
          tension: 0.3
        }]
      }
    });

    // Pie Chart
    new Chart(document.getElementById("pieChart"), {
      type: "pie",
      data: {
        labels: ["Male", "Female"],
        datasets: [{
          data: [3850, 3600],
          backgroundColor: ["#667eea", "#764ba2"]
        }]
      }
    });

    // Bar Chart
    new Chart(document.getElementById("barChart"), {
      type: "bar",
      data: {
        labels: ["North", "South", "East"],
        datasets: [{
          label: "Dropout Rate (%)",
          data: [11, 14, 12],
          backgroundColor: "#764ba2"
        }]
      }
    });
  </script>
</body>

</html>